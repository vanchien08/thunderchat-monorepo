services:
  # Gateway
  - type: web
    name: thunderchat-gateway
    runtime: node
    buildCommand: cd apps/gateway && npm install && npm run build
    startCommand: cd apps/gateway && npm run start:prod
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 10000

  # User Auth Service
  - type: web
    name: thunderchat-user-auth
    runtime: node
    buildCommand: cd apps/user-auth-service && npm install && npm run build
    startCommand: cd apps/user-auth-service && npm run start:prod
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 10000

  # Chat Service
  - type: web
    name: thunderchat-chat
    runtime: node
    buildCommand: cd apps/chat-service && npm install && npm run build
    startCommand: cd apps/chat-service && npm run start:prod
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 10000

  # Call Service
  - type: web
    name: thunderchat-call
    runtime: node
    buildCommand: cd apps/call-service && npm install && npm run build
    startCommand: cd apps/call-service && npm run start:prod
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 10000

  # Search Service
  - type: web
    name: thunderchat-search
    runtime: node
    buildCommand: cd apps/search-service && npm install && npm run build
    startCommand: cd apps/search-service && npm run start:prod
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 10000

  # Notification Service
  - type: web
    name: thunderchat-notification
    runtime: node
    buildCommand: cd apps/notification-service && npm install && npm run build
    startCommand: cd apps/notification-service && npm run start:prod
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 10000

  # Conversation Service
  - type: web
    name: thunderchat-conversation
    runtime: node
    buildCommand: cd apps/conversation-service && npm install && npm run build
    startCommand: cd apps/conversation-service && npm run start:prod
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 10000

  # Media Service
  - type: web
    name: thunderchat-media
    runtime: node
    buildCommand: cd apps/media-service && npm install && npm run build
    startCommand: cd apps/media-service && npm run start:prod
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 10000

  # Admin Service
  - type: web
    name: thunderchat-admin
    runtime: node
    buildCommand: cd apps/admin-service && npm install && npm run build
    startCommand: cd apps/admin-service && npm run start:prod
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 10000

  # PostgreSQL Database (Free tier)
  - type: pgsql
    name: thunderchat-db
    ipAllowList: []
